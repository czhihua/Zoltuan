"use strict";$(function(){var n,i,t,a;tiaozhuang(),pullDown("hnav-menu","sub-Menus","onmouseover"),n=$(window).height(),$(".sidebar").css("height",n),$(".sidebar-nav li").css("height",n),$(".sidebar-nav").css("height",n),$(window).resize(function(){n=$(window).height(),$(".sidebar").css("height",n),$(".sidebar-nav li").css("height",n),$(".sidebar-nav ").css("height",n)}),$(".tabbox div").hover(function(){$(this).find("span").stop().animate({left:"-80px"})},function(){$(this).find("span").stop().animate({left:"37px"})}),t=!(i=!0),$(".tabbox").on("click","div",function(){if(i){$("#sidebar").stop().animate({right:0});var n=$(this).index();$(".tabbox div").attr("data-a",""),$(this).attr("data-a",n+1),$(".sidebar-nav li").css({top:"100%",opacity:0}),$(".sidebar-nav li").eq($(this).index()).stop().animate({top:"0",opacity:1}),t=!0}else $("#sidebar").stop().animate({right:"-253px"}),i=!0}),$(".tabbox div").on("click",function(){if(t){var n=$(this).attr("data-a"),a=$(this).index()+1;console.log(n,a),n==a?i=!1:$(this).stop().animate({}),$(".tabbox div").attr("data-a","")}}),$(".sn-btn").on("click",function(){$("#sidebar").stop().animate({right:"-253px"}),i=!0,$(".tabbox div").attr("data-a","")}),(a=window.localStorage.getItem("username"))?($(".ht-login").find("i").text("您好，"+a),$(".ht-login").find("a").css("display","none"),$(".ht-res").css("display","none"),$(".ht-quit").css("display","inline"),$.ajax({type:"post",url:"../api/goodlist.php",data:{dbsql:"cart",user:a},success:function(n){var a=JSON.parse(n);$(".ht-nav li:eq(2)").find("a").html("购物车"+a.total1+"件"),$(".qe-cart").find("em").html(a.total1),$(".ht-nav li:eq(2)").on("click",function(){location.href="cart.html"}),$(".qe-cart").on("click",function(){location.href="cart.html"})}})):($(".ht-login").find("i").text("Hi~欢迎来到Z商城，请"),$(".ht-login").find("a").css("display","inline"),$(".ht-res").css("display","inline"),$(".ht-quit").css("display","none"),$(".qe-cart").on("click",function(){var n=window.location.pathname,a=window.location.search;location.href="login.html?"+n+a}),$(".ht-nav li:eq(2)").on("click",function(){var n=window.location.pathname,a=window.location.search;location.href="login.html?"+n+a})),$(".ht-quit").on("click",function(){var n=window.location.search,a=window.localStorage;a.clear(),location.href="detail.html"+n}),function(){var n=window.location.search;if(n){var a=n.substring(1).split("=");$.ajax({type:"post",url:"../api/detail.php",data:{dbsql:"rush",id:a[1]},success:function(n){for(var t=JSON.parse(n)[0],a=[t.pic,t.pic1],i="",s=0;s<a.length;s++)i+='<li class="">\n                            <div class="small-img">\n                                <img src="../img/'+a[s]+'" />\n                            </div>\n                        </li>';$(".animation03").html(i),$(".animation03 li").eq(0).attr("class","samll-active"),$(".animation03").on("click","li",function(){$(".animation03 li").attr("class",""),$(this).attr("class","samll-active")}),magnifier({magnifier:"#magnifier1",width:400,height:400,moveWidth:null,zoom:2});var e='\x3c!-- 头部信息 --\x3e\n                        <div class="detail-title" data-id="'+t.productid+'">\n                            \x3c!-- 商品名字 --\x3e\n                            <span class="goods-name">'+t.goodsName+'</span>\n                            <br>\n                            \x3c!-- 商品介绍 --\x3e\n                            <span class="goods-introduce">'+t.intro+'</span>\n                        </div>\n                        \x3c!-- logo --\x3e\n                        <div class="group-box">\n                            <div class="group-logo">\n                                <a class="mall-logo" href="javascript:;"></a>\n                                <i>|</i>\n                                <a class="g-logo" href="javascript:;"></a>\n                            </div>\n                            \x3c!-- 结束时间 --\x3e\n                            <div class="over-time">\n                                距结束还剩下\n                                <span>0天</span>\n                                <span class="time-num">00</span>\n                                :\n                                <span class="time-num">00</span>\n                                :\n                                <span class="time-num">00</span>\n                            </div>\n\n\n                        </div>\n\n                        \x3c!-- 价格 --\x3e\n                        <div class="g-price">\n                            <dl class="sale-price">\n                                <dt>\n                                    <span>团购价：</span>\n                                </dt>\n                                <dd>\n                                    <span>￥\n                                        <em>'+t.current+'</em>\n                                    </span>\n                                    <span class="g-original">\n                                        ￥'+t.original+'\n                                    </span>\n                                    <span class="g-save">\n                                        立省'+1*(t.original-t.current)+'元\n                                    </span>\n                                </dd>\n                            </dl>\n                        </div>\n\n                        \x3c!-- 购买信息 --\x3e\n                        <div class="information">\n                            \x3c!-- 配送选择 --\x3e\n                            <div class="distribution">\n                                <dl>\n                                    <dt>\n                                        <span>配送</span>\n                                    </dt>\n                                    <dd>\n                                        <span class="site-name">广东\n                                            <i></i>\n                                        </span>\n                                        <span>\n                                            可送达，快递包裹\n                                        </span>\n                                    </dd>\n                                </dl>\n\n                            </div>\n\n                            \x3c!-- 平价和交易记录 --\x3e\n\n                            <div class="evaluate">\n                                <dl>\n                                    <dt>评价</dt>\n                                    <dd>\n                                        <a href="javascript:;">购买评价\n                                            <em>80</em>\n                                        </a>\n                                        <i>|</i>\n                                        <a href="javascript:;">成交记录\n                                            <em>150</em>\n                                        </a>\n                                    </dd>\n                                </dl>\n                            </div>\n\n                            \x3c!-- 服务保障 --\x3e\n                            <div class="serve">\n                                <dl>\n                                    <dt>服务保障</dt>\n                                    <dd class="shop_serve">由\n                                        <a href="javascript:;">'+t.shop+'</a>\n                                        发货并承诺提供以下服务保障\n                                    </dd>\n                                    <br>\n                                    <dd class="serve-icon">\n                                        <a href="javascript:;">\n                                            <i></i>正品保障\n                                        </a>\n                                        <a href="javascript:;">\n                                            <i></i>发票保障\n                                        </a>\n                                        <a href="javascript:;">\n                                            <i></i>无忧退换\n                                        </a>\n                                    </dd>\n                                </dl>\n                            </div>\n\n                            \x3c!-- 团购商品 --\x3e\n                            <div class="group-form">\n                                \x3c!-- 团购商品 --\x3e\n                                <div class="form-type">\n                                    <dl>\n                                        <dt>团购商品：</dt>\n                                        <dd>\n                                            <i class="icon">团</i>\n                                            '+t.color+'\n                                        </dd>\n                                    </dl>\n                                </div>\n                                \x3c!-- 颜色 --\x3e\n                                <div class="color-type">\n                                    <dl>\n                                        <dt>颜色类别:</dt>\n                                        <dd>\n                                            <a class="check" href="javascript:;">'+t.color+'\n                                                <i></i>\n                                            </a>\n                                        </dd>\n                                    </dl>\n                                </div>\n\n                                \x3c!-- 套装 --\x3e\n                                <div class="suit suit-type">\n                                    <dl>\n                                        <dt>套装</dt>\n                                        <dd>\n                                            <a class="check" href="javascript:;">官方标配\n                                                <i></i>\n                                            </a>\n                                        </dd>\n                                        <br>\n                                        <dd>\n                                            <div>官方标配说明官方标配说明官方标配说明官方标配说明官方标配说明</div>\n                                        </dd>\n                                    </dl>\n                                </div>\n\n                                \x3c!-- 购买数量 --\x3e\n                                <div class="quantity">\n                                    <dl>\n                                        <dt>购买数量</dt>\n                                        <dd>\n                                            <span class="prve">-</span>\n                                            <input type="number"  value="1">\n                                            <span class="next">+</span>\n                                            <i>件</i>\n                                            <em>(限购\n                                                <b style="font-weight:normal;">'+t.quota+'</b>件)</em>\n                                        </dd>\n                                    </dl>\n                                </div>\n\n                                \x3c!-- 按钮 --\x3e\n                                <div class="buy-btn">\n                                    <span id="promptly-btn">立即购买</span>\n                                    <span id="addCart">加入购物车</span>\n                                </div>\n                            </div>\n                        </div>';$(".dbox-details").html(e),window.localStorage.getItem("username")?function(){var n=$(".quantity input").val(),a=$(".quantity b").text();$(".quantity .prve").on("click",function(){n=--n<=0?1:n,$(".quantity input").val(n)}),$(".quantity .next").on("click",function(){n=++n>=a?a:n,$(".quantity input").val(n)}),$(".quantity input").on("blur",function(){console.log();var n=$(".quantity input").val();(n<=0||!n)&&$(".quantity input").val(1)}),$("#addCart,#promptly-btn").on("click",function(){var n=$(".dbox-details .detail-title").attr("data-id"),a=$(".quantity input").val(),i=window.localStorage,t=i.getItem("username");$.ajax({type:"post",url:"../api/insertcart.php",data:{dbsql:"rush",todbsql:"cart",goodsnum:a,pid:n,user:t},success:function(n){0==n&&($("#goodsremind").css("display","block"),$(".gocart").on("click",function(){location.href="cart.html"}),$(".continue").on("click",function(){$("#goodsremind").css("display","none")}),$(".remind .colse").on("click",function(){$("#goodsremind").css("display","none")}),$.ajax({type:"post",url:"../api/goodlist.php",data:{dbsql:"cart",user:t},success:function(n){var a=JSON.parse(n);$("#cart-number").text(a.total1);for(var i=0,t=0;t<a.data.length;t++)i+=a.data[t].current*a.data[t].num;$("#total-price").text(i)}}))}})})}():$("#addCart,#promptly-btn").on("click",function(){var n=window.location.pathname,a=window.location.search;location.href="login.html?"+n+a}),setInterval(function(){var n=(new Date).getTime(),a=1*t.time-n,i=getDuration(a);$(".over-time").html("\n                                        距结束还剩下\n                                        <span>"+toDB(i[0])+'天</span>\n                                        <span class="time-num">'+toDB(i[1])+'</span>\n                                        :\n                                        <span class="time-num">'+toDB(i[2])+'</span>\n                                        :\n                                        <span class="time-num">'+toDB(i[3])+"</span>\n                                    ")},1e3);var c=1;$.ajax({type:"post",url:"../api/query.php",data:{dbsql:"rush",page:c,num:3,query:t.type,name:"type"},success:function(n){var a=JSON.parse(n),i=a.data.map(function(n){return'<li>\n                            <a class="re-pic" href="javascript:;">\n                                <img src="../img/'+n.pic+'" alt="">\n                            </a>\n                            <p class="re-name">\n                                <a href="javascript:;">'+n.goodsName+'</a>\n                            </p>\n                            <p class="re-price">\n                                <span class="re-current">￥'+n.current+'</span>\n                                <span class="re-original">￥'+n.original+"</span>\n                            </p>\n                        </li>"});$(".re-list").html(i),$("#re-tab").on("click",function(){c=++c>Math.ceil(a.total/a.num)?1:c,$.ajax({type:"post",url:"../api/query.php",data:{dbsql:"rush",page:c,num:3,query:t.type,name:"type"},success:function(n){var a=JSON.parse(n).data.map(function(n){return'<li>\n                            <a class="re-pic" href="javascript:;">\n                                <img src="../img/'+n.pic+'" alt="">\n                            </a>\n                            <p class="re-name">\n                                <a href="javascript:;">'+n.goodsName+'</a>\n                            </p>\n                            <p class="re-price">\n                                <span class="re-current">￥'+n.current+'</span>\n                                <span class="re-original">￥'+n.original+"</span>\n                            </p>\n                        </li>"});$(".re-list").html(a)}})})}})}})}}(),$(".ht-login a").on("click",function(){var n=window.location.pathname,a=window.location.search;location.href="login.html?"+n+a}),$(".detail-tab").on("click","li",function(){$(".detail-tab li").attr("class",""),$(this).attr("class","active"),$(".tab-inner").find("div").css("display","none"),$(".tab-inner").find("div").eq($(this).index()).css("display","block")})});